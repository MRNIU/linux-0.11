<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linux: /home/runner/work/linux-0.11/linux-0.11/src/fs/stat.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linux
   &#160;<span id="projectnumber">0.11</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('src_2fs_2stat_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">stat.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;linux/fs.h&gt;</code><br />
<code>#include &lt;linux/sched.h&gt;</code><br />
<code>#include &lt;linux/kernel.h&gt;</code><br />
<code>#include &lt;asm/segment.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stat.c:</div>
<div class="dyncontent">
<div class="center"><img src="src_2fs_2stat_8c__incl.png" border="0" usemap="#a_2home_2runner_2work_2linux-0_811_2linux-0_811_2src_2fs_2stat_8c" alt=""/></div>
<map name="a_2home_2runner_2work_2linux-0_811_2linux-0_811_2src_2fs_2stat_8c" id="a_2home_2runner_2work_2linux-0_811_2linux-0_811_2src_2fs_2stat_8c">
<area shape="rect" title=" " alt="" coords="218,5,399,61"/>
<area shape="rect" title=" " alt="" coords="5,109,73,136"/>
<area shape="rect" title=" " alt="" coords="98,109,183,136"/>
<area shape="rect" title=" " alt="" coords="207,109,290,136"/>
<area shape="rect" title=" " alt="" coords="315,109,423,136"/>
<area shape="rect" title=" " alt="" coords="447,109,557,136"/>
<area shape="rect" title=" " alt="" coords="582,109,705,136"/>
</map>
</div>
</div>
<p><a href="src_2fs_2stat_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae9bbfad9a19a302b82cf82046bbb524e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="src_2fs_2stat_8c.html#ae9bbfad9a19a302b82cf82046bbb524e">cp_stat</a> (struct <a class="el" href="structm__inode.html">m_inode</a> *inode, struct <a class="el" href="structstat.html">stat</a> *statbuf)</td></tr>
<tr class="separator:ae9bbfad9a19a302b82cf82046bbb524e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d4a37bb6cbbf7fe6db13504f67d9234"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="src_2fs_2stat_8c.html#a8d4a37bb6cbbf7fe6db13504f67d9234">sys_stat</a> (char *filename, struct <a class="el" href="structstat.html">stat</a> *statbuf)</td></tr>
<tr class="separator:a8d4a37bb6cbbf7fe6db13504f67d9234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a116c0c99bed8d1246fe4ad85421b14c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="src_2fs_2stat_8c.html#a116c0c99bed8d1246fe4ad85421b14c5">sys_fstat</a> (unsigned int fd, struct <a class="el" href="structstat.html">stat</a> *statbuf)</td></tr>
<tr class="separator:a116c0c99bed8d1246fe4ad85421b14c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae9bbfad9a19a302b82cf82046bbb524e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9bbfad9a19a302b82cf82046bbb524e">&#9670;&nbsp;</a></span>cp_stat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void cp_stat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structm__inode.html">m_inode</a> *&#160;</td>
          <td class="paramname"><em>inode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structstat.html">stat</a> *&#160;</td>
          <td class="paramname"><em>statbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="src_2fs_2stat_8c_source.html#l00011">11</a> of file <a class="el" href="src_2fs_2stat_8c_source.html">stat.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                                                                 {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keyword">struct </span><a class="code" href="structstat.html">stat</a> tmp;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">// 首先验证(或分配)存放数据的内存空间。</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="flash_2Linux-0_811_2include_2linux_2kernel_8h.html#afc318b86ebf9e88f5af7ca7077098a7f">verify_area</a>(statbuf, <span class="keyword">sizeof</span>(*statbuf));</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// 然后临时复制相应节点上的信息。</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    tmp.st_dev = inode-&gt;<a class="code" href="structm__inode.html#ab7137e3d8956c00cc96dbbb641d5f7b0">i_dev</a>;    <span class="comment">// 文件所在的设备号。</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    tmp.st_ino = inode-&gt;<a class="code" href="structm__inode.html#a939c155d0ad423600b89cfff65dbc8d6">i_num</a>;    <span class="comment">// 文件i 节点号。</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    tmp.st_mode = inode-&gt;<a class="code" href="structm__inode.html#a8e7ad442dc54bb004462f2e82609ee06">i_mode</a>;    <span class="comment">// 文件属性。</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    tmp.st_nlink = inode-&gt;<a class="code" href="structm__inode.html#a844dbde82fceb30c92a79e3d3b8f2f0f">i_nlinks</a>;    <span class="comment">// 文件的连接数。</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    tmp.st_uid = inode-&gt;<a class="code" href="structm__inode.html#ad83b88391e00d6d78725c5b247bbe490">i_uid</a>;    <span class="comment">// 文件的用户id。</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    tmp.st_gid = inode-&gt;<a class="code" href="structm__inode.html#acc04fc74f923841f8b6083284a6e1884">i_gid</a>;    <span class="comment">// 文件的组id。</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    tmp.st_rdev = inode-&gt;<a class="code" href="structm__inode.html#ab5259e1fa50415a968e5558ca2e92d9f">i_zone</a>[0];    <span class="comment">// 设备号(如果文件是特殊的字符文件或块文件)。</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    tmp.st_size = inode-&gt;<a class="code" href="structm__inode.html#a221b9232932ba984b5a3230e1b98f52e">i_size</a>;    <span class="comment">// 文件大小（字节数）（如果文件是常规文件）。</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    tmp.st_atime = inode-&gt;<a class="code" href="structm__inode.html#a520648e8cf3857e485b6396fb4c2c048">i_atime</a>;    <span class="comment">// 最后访问时间。</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    tmp.st_mtime = inode-&gt;<a class="code" href="structm__inode.html#a14bbd28dd778926da9a6688bd1ea0fea">i_mtime</a>;    <span class="comment">// 最后修改时间。</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    tmp.st_ctime = inode-&gt;<a class="code" href="structm__inode.html#a50157b5c9346b2e6d448225d67d07de0">i_ctime</a>;    <span class="comment">// 最后节点修改时间。</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">// 最后将这些状态信息复制到用户缓冲区中。</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span>(tmp); i++)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <a class="code" href="flash_2Linux-0_811_2include_2asm_2segment_8h.html#a8d241e819a095a0ad63eb07ca481e323">put_fs_byte</a>(((<span class="keywordtype">char</span> *) &amp;tmp)[i], &amp;((<span class="keywordtype">char</span> *) statbuf)[i]);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2asm_2segment_8h_html_a8d241e819a095a0ad63eb07ca481e323"><div class="ttname"><a href="flash_2Linux-0_811_2include_2asm_2segment_8h.html#a8d241e819a095a0ad63eb07ca481e323">put_fs_byte</a></div><div class="ttdeci">static void put_fs_byte(char val, char *addr)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2asm_2segment_8h_source.html#l00025">segment.h:25</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2kernel_8h_html_afc318b86ebf9e88f5af7ca7077098a7f"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2kernel_8h.html#afc318b86ebf9e88f5af7ca7077098a7f">verify_area</a></div><div class="ttdeci">void verify_area(void *addr, int count)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2fork_8c_source.html#l00024">fork.c:24</a></div></div>
<div class="ttc" id="astructm__inode_html_a14bbd28dd778926da9a6688bd1ea0fea"><div class="ttname"><a href="structm__inode.html#a14bbd28dd778926da9a6688bd1ea0fea">m_inode::i_mtime</a></div><div class="ttdeci">unsigned long i_mtime</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00097">fs.h:97</a></div></div>
<div class="ttc" id="astructm__inode_html_a221b9232932ba984b5a3230e1b98f52e"><div class="ttname"><a href="structm__inode.html#a221b9232932ba984b5a3230e1b98f52e">m_inode::i_size</a></div><div class="ttdeci">unsigned long i_size</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00096">fs.h:96</a></div></div>
<div class="ttc" id="astructm__inode_html_a50157b5c9346b2e6d448225d67d07de0"><div class="ttname"><a href="structm__inode.html#a50157b5c9346b2e6d448225d67d07de0">m_inode::i_ctime</a></div><div class="ttdeci">unsigned long i_ctime</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00104">fs.h:104</a></div></div>
<div class="ttc" id="astructm__inode_html_a520648e8cf3857e485b6396fb4c2c048"><div class="ttname"><a href="structm__inode.html#a520648e8cf3857e485b6396fb4c2c048">m_inode::i_atime</a></div><div class="ttdeci">unsigned long i_atime</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00103">fs.h:103</a></div></div>
<div class="ttc" id="astructm__inode_html_a844dbde82fceb30c92a79e3d3b8f2f0f"><div class="ttname"><a href="structm__inode.html#a844dbde82fceb30c92a79e3d3b8f2f0f">m_inode::i_nlinks</a></div><div class="ttdeci">unsigned char i_nlinks</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00099">fs.h:99</a></div></div>
<div class="ttc" id="astructm__inode_html_a8e7ad442dc54bb004462f2e82609ee06"><div class="ttname"><a href="structm__inode.html#a8e7ad442dc54bb004462f2e82609ee06">m_inode::i_mode</a></div><div class="ttdeci">unsigned short i_mode</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00094">fs.h:94</a></div></div>
<div class="ttc" id="astructm__inode_html_a939c155d0ad423600b89cfff65dbc8d6"><div class="ttname"><a href="structm__inode.html#a939c155d0ad423600b89cfff65dbc8d6">m_inode::i_num</a></div><div class="ttdeci">unsigned short i_num</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00106">fs.h:106</a></div></div>
<div class="ttc" id="astructm__inode_html_ab5259e1fa50415a968e5558ca2e92d9f"><div class="ttname"><a href="structm__inode.html#ab5259e1fa50415a968e5558ca2e92d9f">m_inode::i_zone</a></div><div class="ttdeci">unsigned short i_zone[9]</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00100">fs.h:100</a></div></div>
<div class="ttc" id="astructm__inode_html_ab7137e3d8956c00cc96dbbb641d5f7b0"><div class="ttname"><a href="structm__inode.html#ab7137e3d8956c00cc96dbbb641d5f7b0">m_inode::i_dev</a></div><div class="ttdeci">unsigned short i_dev</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00105">fs.h:105</a></div></div>
<div class="ttc" id="astructm__inode_html_acc04fc74f923841f8b6083284a6e1884"><div class="ttname"><a href="structm__inode.html#acc04fc74f923841f8b6083284a6e1884">m_inode::i_gid</a></div><div class="ttdeci">unsigned char i_gid</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00098">fs.h:98</a></div></div>
<div class="ttc" id="astructm__inode_html_ad83b88391e00d6d78725c5b247bbe490"><div class="ttname"><a href="structm__inode.html#ad83b88391e00d6d78725c5b247bbe490">m_inode::i_uid</a></div><div class="ttdeci">unsigned short i_uid</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00095">fs.h:95</a></div></div>
<div class="ttc" id="astructstat_html"><div class="ttname"><a href="structstat.html">stat</a></div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2sys_2stat_8h_source.html#l00006">stat.h:6</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="src_2fs_2stat_8c_ae9bbfad9a19a302b82cf82046bbb524e_cgraph.png" border="0" usemap="#asrc_2fs_2stat_8c_ae9bbfad9a19a302b82cf82046bbb524e_cgraph" alt=""/></div>
<map name="asrc_2fs_2stat_8c_ae9bbfad9a19a302b82cf82046bbb524e_cgraph" id="asrc_2fs_2stat_8c_ae9bbfad9a19a302b82cf82046bbb524e_cgraph">
<area shape="rect" title=" " alt="" coords="5,689,75,716"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2asm_2segment_8h.html#a8d241e819a095a0ad63eb07ca481e323" title=" " alt="" coords="123,664,221,691"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2kernel_8h.html#afc318b86ebf9e88f5af7ca7077098a7f" title=" " alt="" coords="125,715,219,741"/>
<area shape="rect" href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702" title=" " alt="" coords="293,335,345,361"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2fork_8c.html#abe18d0a2e79d311f52c8c127665239d6" title=" " alt="" coords="269,740,368,767"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2ll__rw__blk_8c.html#a628fc567a905186248e1ead5565f3b50" title=" " alt="" coords="417,56,518,83"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2buffer_8c.html#a008e777b9e9f7711d783bf16505bd714" title=" " alt="" coords="423,107,511,133"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2chr__drv_2tty__io_8c.html#ac90c768857a93aa43bc76c21efd88cde" title=" " alt="" coords="417,157,518,184"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2floppy_8c.html#a627138ff394a15374ddc80bba277550f" title=" " alt="" coords="422,208,513,235"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#acd2e1ded4bb6fce4500438bf928330f4" title=" " alt="" coords="625,157,673,184"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2hd_8c.html#a7b2099a07d66bdebdea911d947280854" title=" " alt="" coords="434,259,501,285"/>
<area shape="rect" href="flash_2Linux-0_811_2init_2main_8c.html#a2858154e2009b0e6e616f313177762bc" title=" " alt="" coords="446,360,489,387"/>
<area shape="rect" href="flash_2Linux-0_811_2mm_2memory_8c.html#a570fcb455a6b0459ada06e7825b783f2" title=" " alt="" coords="425,411,509,437"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a47a6ff5872f457ee230458137f2b2409" title=" " alt="" coords="437,461,498,488"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2ramdisk_8c.html#a4257f1a08e61c6f803f7448371ac381f" title=" " alt="" coords="436,512,499,539"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#ac76f0bd4fbafc057a2f780869968e3ed" title=" " alt="" coords="423,563,511,589"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a7fd306118b826212968bc1f2d4045f61" title=" " alt="" coords="429,1069,505,1096"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2tty_8h.html#a0d6679c5a4b8b74b22afc33d06d64eec" title=" " alt="" coords="433,5,501,32"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2floppy_8c.html#aa18fcbf9ad09baf8a860573bc032e4fa" title=" " alt="" coords="586,56,711,83"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2hd_8c.html#a519bfb5b2d4694f1c2f97a900705e55a" title=" " alt="" coords="598,107,699,133"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a86f37095532694250eeae79115aebda0" title=" " alt="" coords="621,411,676,437"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#aacad1d135ca2779b583623678e36db7c" title=" " alt="" coords="621,461,677,488"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a6363aa4e42f01c8c657effa91abfa421" title=" " alt="" coords="625,512,672,539"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a5e8f2ca678b1244e265b9e6bfc7cc64a" title=" " alt="" coords="615,563,683,589"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2fcntl_8h.html#ae228c30ac0826ace5835545e40416e57" title=" " alt="" coords="621,613,676,640"/>
<area shape="rect" href="flash_2Linux-0_811_2init_2main_8c.html#afa32ff5c94c64dff2713d712e0526cfe" title=" " alt="" coords="620,208,677,235"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a3dc7e94fe9c483eea915fbc0334be0b2" title=" " alt="" coords="618,259,679,285"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#ac5995ca88c88de0157244e5f47dd4780" title=" " alt="" coords="623,309,675,336"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2sys_2wait_8h.html#a1b535bc16327bd87c7f9c1331c3d2bd7" title=" " alt="" coords="623,360,674,387"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a8f9679ccc213b2e80a3ec58d28abb387" title=" " alt="" coords="614,1272,683,1299"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#afa81779d9d75b45b852dd58ed968732a" title=" " alt="" coords="579,1323,718,1349"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a7e24147f2a84260c1b26ad061d135fe4" title=" " alt="" coords="567,1374,731,1415"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a146ba59440b7ebfb099f2ceb23d0a60f" title=" " alt="" coords="617,1440,680,1467"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a26d7f69418cc6a5aa9d9153d43e9632a" title=" " alt="" coords="569,1491,729,1517"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#aa576d0c4f8920b5437af7b8d4564d032" title=" " alt="" coords="599,1541,699,1568"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a68ea9321b4398cdd0db2a86ad8a59967" title=" " alt="" coords="597,1592,700,1619"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a3a004fa105f4b77ec27e70ebc7e34c91" title=" " alt="" coords="577,664,721,691"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#ae335c1861c4d66f0261c9052e6dcfc6c" title=" " alt="" coords="625,715,672,741"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a015a584cc3b6f8ac504279683e96e495" title=" " alt="" coords="604,765,693,792"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#ae0d70fedb9587180712fe3246922c555" title=" " alt="" coords="600,816,697,843"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a035c5d689f6583512ea6624adad5e00f" title=" " alt="" coords="621,867,676,893"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#add85efcd0f679b2bf261890fd9a3bdb3" title=" " alt="" coords="625,917,672,944"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#ab69b13817a99feddc272895027a4c4e2" title=" " alt="" coords="609,968,688,995"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#afa41580818a256dccd45c27d8488f435" title=" " alt="" coords="603,1019,694,1045"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a90bc6980de335a04f4878638324f272c" title=" " alt="" coords="581,1069,716,1096"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#aba652690756ff9e349625bfc93cf8e30" title=" " alt="" coords="609,1120,688,1147"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a73b48fccd61a718cc7d60884b111760e" title=" " alt="" coords="567,1171,730,1197"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a3c99e79fa2b3fb1327f6007037f12982" title=" " alt="" coords="588,1221,709,1248"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2tty_8h.html#a336b8a5c417f4a043ffc1143fc2aef99" title=" " alt="" coords="612,5,685,32"/>
<area shape="rect" href="flash_2Linux-0_811_2mm_2memory_8c.html#a7beb786b07c313c61111c5709391f3d3" title=" " alt="" coords="416,1120,519,1147"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="src_2fs_2stat_8c_ae9bbfad9a19a302b82cf82046bbb524e_icgraph.png" border="0" usemap="#asrc_2fs_2stat_8c_ae9bbfad9a19a302b82cf82046bbb524e_icgraph" alt=""/></div>
<map name="asrc_2fs_2stat_8c_ae9bbfad9a19a302b82cf82046bbb524e_icgraph" id="asrc_2fs_2stat_8c_ae9bbfad9a19a302b82cf82046bbb524e_icgraph">
<area shape="rect" title=" " alt="" coords="135,31,204,57"/>
<area shape="rect" href="src_2fs_2stat_8c.html#a116c0c99bed8d1246fe4ad85421b14c5" title=" " alt="" coords="5,5,87,32"/>
<area shape="rect" href="src_2fs_2stat_8c.html#a8d4a37bb6cbbf7fe6db13504f67d9234" title=" " alt="" coords="8,56,84,83"/>
</map>
</div>

</div>
</div>
<a id="a116c0c99bed8d1246fe4ad85421b14c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a116c0c99bed8d1246fe4ad85421b14c5">&#9670;&nbsp;</a></span>sys_fstat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_fstat </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structstat.html">stat</a> *&#160;</td>
          <td class="paramname"><em>statbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="src_2fs_2stat_8c_source.html#l00052">52</a> of file <a class="el" href="src_2fs_2stat_8c_source.html">stat.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                                     {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">struct </span><a class="code" href="structfile.html">file</a> *f;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">struct </span><a class="code" href="structm__inode.html">m_inode</a> *inode;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// 如果文件句柄值大于一个程序最多打开文件数 NR_OPEN，或者该句柄的文件结构指针为空，或者</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// 对应文件结构的 i 节点字段为空，则出错，返回出错码并退出。</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (fd &gt;= <a class="code" href="flash_2Linux-0_811_2include_2linux_2fs_8h.html#a326ba885b33e0ac094fec455a1ec30b3">NR_OPEN</a> || !(f = <a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#af92b36c90c0636553c690c20ecc9553e">filp</a>[fd]) || !(inode = f-&gt;<a class="code" href="structfile.html#ae57c18a676dcd6ef788b20512bd995e3">f_inode</a>))</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="flash_2Linux-0_811_2include_2errno_8h.html#ac54507d66b43ad12f9356257323c0018">EBADF</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// 将i 节点上的文件状态信息复制到用户缓冲区中。</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="src_2fs_2stat_8c.html#ae9bbfad9a19a302b82cf82046bbb524e">cp_stat</a>(inode, statbuf);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2errno_8h_html_ac54507d66b43ad12f9356257323c0018"><div class="ttname"><a href="flash_2Linux-0_811_2include_2errno_8h.html#ac54507d66b43ad12f9356257323c0018">EBADF</a></div><div class="ttdeci">#define EBADF</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2errno_8h_source.html#l00028">errno.h:28</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2fs_8h_html_a326ba885b33e0ac094fec455a1ec30b3"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2fs_8h.html#a326ba885b33e0ac094fec455a1ec30b3">NR_OPEN</a></div><div class="ttdeci">#define NR_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00043">fs.h:43</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a476ec09a598028a09942c2233aa5127e"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a></div><div class="ttdeci">struct task_struct * current</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2sched_8c_source.html#l00062">sched.c:62</a></div></div>
<div class="ttc" id="asrc_2fs_2stat_8c_html_ae9bbfad9a19a302b82cf82046bbb524e"><div class="ttname"><a href="src_2fs_2stat_8c.html#ae9bbfad9a19a302b82cf82046bbb524e">cp_stat</a></div><div class="ttdeci">static void cp_stat(struct m_inode *inode, struct stat *statbuf)</div><div class="ttdef"><b>Definition:</b> <a href="src_2fs_2stat_8c_source.html#l00011">stat.c:11</a></div></div>
<div class="ttc" id="astructfile_html"><div class="ttname"><a href="structfile.html">file</a></div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00116">fs.h:116</a></div></div>
<div class="ttc" id="astructfile_html_ae57c18a676dcd6ef788b20512bd995e3"><div class="ttname"><a href="structfile.html#ae57c18a676dcd6ef788b20512bd995e3">file::f_inode</a></div><div class="ttdeci">struct m_inode * f_inode</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00120">fs.h:120</a></div></div>
<div class="ttc" id="astructm__inode_html"><div class="ttname"><a href="structm__inode.html">m_inode</a></div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00093">fs.h:93</a></div></div>
<div class="ttc" id="astructtask__struct_html_af92b36c90c0636553c690c20ecc9553e"><div class="ttname"><a href="structtask__struct.html#af92b36c90c0636553c690c20ecc9553e">task_struct::filp</a></div><div class="ttdeci">struct file * filp[NR_OPEN]</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00104">sched.h:104</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="src_2fs_2stat_8c_a116c0c99bed8d1246fe4ad85421b14c5_cgraph.png" border="0" usemap="#asrc_2fs_2stat_8c_a116c0c99bed8d1246fe4ad85421b14c5_cgraph" alt=""/></div>
<map name="asrc_2fs_2stat_8c_a116c0c99bed8d1246fe4ad85421b14c5_cgraph" id="asrc_2fs_2stat_8c_a116c0c99bed8d1246fe4ad85421b14c5_cgraph">
<area shape="rect" title=" " alt="" coords="5,689,87,716"/>
<area shape="rect" href="src_2fs_2stat_8c.html#ae9bbfad9a19a302b82cf82046bbb524e" title=" " alt="" coords="135,689,204,716"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2asm_2segment_8h.html#a8d241e819a095a0ad63eb07ca481e323" title=" " alt="" coords="252,664,351,691"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2kernel_8h.html#afc318b86ebf9e88f5af7ca7077098a7f" title=" " alt="" coords="254,715,349,741"/>
<area shape="rect" href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702" title=" " alt="" coords="422,335,474,361"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2fork_8c.html#abe18d0a2e79d311f52c8c127665239d6" title=" " alt="" coords="399,740,497,767"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2ll__rw__blk_8c.html#a628fc567a905186248e1ead5565f3b50" title=" " alt="" coords="546,56,647,83"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2buffer_8c.html#a008e777b9e9f7711d783bf16505bd714" title=" " alt="" coords="553,107,641,133"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2chr__drv_2tty__io_8c.html#ac90c768857a93aa43bc76c21efd88cde" title=" " alt="" coords="546,157,647,184"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2floppy_8c.html#a627138ff394a15374ddc80bba277550f" title=" " alt="" coords="551,208,642,235"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#acd2e1ded4bb6fce4500438bf928330f4" title=" " alt="" coords="754,157,802,184"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2hd_8c.html#a7b2099a07d66bdebdea911d947280854" title=" " alt="" coords="563,259,630,285"/>
<area shape="rect" href="flash_2Linux-0_811_2init_2main_8c.html#a2858154e2009b0e6e616f313177762bc" title=" " alt="" coords="575,360,618,387"/>
<area shape="rect" href="flash_2Linux-0_811_2mm_2memory_8c.html#a570fcb455a6b0459ada06e7825b783f2" title=" " alt="" coords="555,411,639,437"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a47a6ff5872f457ee230458137f2b2409" title=" " alt="" coords="566,461,627,488"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2ramdisk_8c.html#a4257f1a08e61c6f803f7448371ac381f" title=" " alt="" coords="565,512,628,539"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#ac76f0bd4fbafc057a2f780869968e3ed" title=" " alt="" coords="553,563,641,589"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a7fd306118b826212968bc1f2d4045f61" title=" " alt="" coords="559,1069,635,1096"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2tty_8h.html#a0d6679c5a4b8b74b22afc33d06d64eec" title=" " alt="" coords="563,5,631,32"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2floppy_8c.html#aa18fcbf9ad09baf8a860573bc032e4fa" title=" " alt="" coords="715,56,841,83"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2hd_8c.html#a519bfb5b2d4694f1c2f97a900705e55a" title=" " alt="" coords="727,107,829,133"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a86f37095532694250eeae79115aebda0" title=" " alt="" coords="751,411,805,437"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#aacad1d135ca2779b583623678e36db7c" title=" " alt="" coords="750,461,806,488"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a6363aa4e42f01c8c657effa91abfa421" title=" " alt="" coords="755,512,801,539"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a5e8f2ca678b1244e265b9e6bfc7cc64a" title=" " alt="" coords="744,563,812,589"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2fcntl_8h.html#ae228c30ac0826ace5835545e40416e57" title=" " alt="" coords="751,613,805,640"/>
<area shape="rect" href="flash_2Linux-0_811_2init_2main_8c.html#afa32ff5c94c64dff2713d712e0526cfe" title=" " alt="" coords="749,208,807,235"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a3dc7e94fe9c483eea915fbc0334be0b2" title=" " alt="" coords="747,259,809,285"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#ac5995ca88c88de0157244e5f47dd4780" title=" " alt="" coords="752,309,804,336"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2sys_2wait_8h.html#a1b535bc16327bd87c7f9c1331c3d2bd7" title=" " alt="" coords="753,360,803,387"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a8f9679ccc213b2e80a3ec58d28abb387" title=" " alt="" coords="743,1272,813,1299"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#afa81779d9d75b45b852dd58ed968732a" title=" " alt="" coords="709,1323,847,1349"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a7e24147f2a84260c1b26ad061d135fe4" title=" " alt="" coords="696,1374,860,1415"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a146ba59440b7ebfb099f2ceb23d0a60f" title=" " alt="" coords="747,1440,809,1467"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a26d7f69418cc6a5aa9d9153d43e9632a" title=" " alt="" coords="698,1491,858,1517"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#aa576d0c4f8920b5437af7b8d4564d032" title=" " alt="" coords="728,1541,828,1568"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a68ea9321b4398cdd0db2a86ad8a59967" title=" " alt="" coords="727,1592,829,1619"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a3a004fa105f4b77ec27e70ebc7e34c91" title=" " alt="" coords="706,664,850,691"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#ae335c1861c4d66f0261c9052e6dcfc6c" title=" " alt="" coords="755,715,801,741"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a015a584cc3b6f8ac504279683e96e495" title=" " alt="" coords="733,765,823,792"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#ae0d70fedb9587180712fe3246922c555" title=" " alt="" coords="729,816,827,843"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a035c5d689f6583512ea6624adad5e00f" title=" " alt="" coords="751,867,805,893"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#add85efcd0f679b2bf261890fd9a3bdb3" title=" " alt="" coords="755,917,801,944"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#ab69b13817a99feddc272895027a4c4e2" title=" " alt="" coords="739,968,817,995"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#afa41580818a256dccd45c27d8488f435" title=" " alt="" coords="733,1019,823,1045"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a90bc6980de335a04f4878638324f272c" title=" " alt="" coords="711,1069,845,1096"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#aba652690756ff9e349625bfc93cf8e30" title=" " alt="" coords="739,1120,817,1147"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a73b48fccd61a718cc7d60884b111760e" title=" " alt="" coords="697,1171,859,1197"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2traps_8c.html#a3c99e79fa2b3fb1327f6007037f12982" title=" " alt="" coords="717,1221,839,1248"/>
<area shape="rect" href="flash_2Linux-0_811_2mm_2memory_8c.html#a7beb786b07c313c61111c5709391f3d3" title=" " alt="" coords="545,1120,648,1147"/>
</map>
</div>

</div>
</div>
<a id="a8d4a37bb6cbbf7fe6db13504f67d9234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d4a37bb6cbbf7fe6db13504f67d9234">&#9670;&nbsp;</a></span>sys_stat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_stat </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structstat.html">stat</a> *&#160;</td>
          <td class="paramname"><em>statbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="src_2fs_2stat_8c_source.html#l00037">37</a> of file <a class="el" href="src_2fs_2stat_8c_source.html">stat.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                                   {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">struct </span><a class="code" href="structm__inode.html">m_inode</a> *inode;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// 首先根据文件名找出对应的 i 节点，若出错则返回错误码。</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">if</span> (!(inode = <a class="code" href="flash_2Linux-0_811_2fs_2namei_8c.html#ae192f1ee0225a7a7c86385b7bf653ac2">namei</a>(filename)))</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="flash_2Linux-0_811_2include_2errno_8h.html#a03e689f378f643d16ea7537918528a48">ENOENT</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// 将 i 节点上的文件状态信息复制到用户缓冲区中，并释放该 i 节点。</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="src_2fs_2stat_8c.html#ae9bbfad9a19a302b82cf82046bbb524e">cp_stat</a>(inode, statbuf);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="flash_2Linux-0_811_2fs_2inode_8c.html#afa76e75f45af948cbb6e5da444038f40">iput</a>(inode);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="ttc" id="aflash_2Linux-0_811_2fs_2inode_8c_html_afa76e75f45af948cbb6e5da444038f40"><div class="ttname"><a href="flash_2Linux-0_811_2fs_2inode_8c.html#afa76e75f45af948cbb6e5da444038f40">iput</a></div><div class="ttdeci">void iput(struct m_inode *inode)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2fs_2inode_8c_source.html#l00150">inode.c:150</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2fs_2namei_8c_html_ae192f1ee0225a7a7c86385b7bf653ac2"><div class="ttname"><a href="flash_2Linux-0_811_2fs_2namei_8c.html#ae192f1ee0225a7a7c86385b7bf653ac2">namei</a></div><div class="ttdeci">struct m_inode * namei(const char *pathname)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2fs_2namei_8c_source.html#l00303">namei.c:303</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2errno_8h_html_a03e689f378f643d16ea7537918528a48"><div class="ttname"><a href="flash_2Linux-0_811_2include_2errno_8h.html#a03e689f378f643d16ea7537918528a48">ENOENT</a></div><div class="ttdeci">#define ENOENT</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2errno_8h_source.html#l00021">errno.h:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="src_2fs_2stat_8c_a8d4a37bb6cbbf7fe6db13504f67d9234_cgraph.png" border="0" usemap="#asrc_2fs_2stat_8c_a8d4a37bb6cbbf7fe6db13504f67d9234_cgraph" alt=""/></div>
<map name="asrc_2fs_2stat_8c_a8d4a37bb6cbbf7fe6db13504f67d9234_cgraph" id="asrc_2fs_2stat_8c_a8d4a37bb6cbbf7fe6db13504f67d9234_cgraph">
<area shape="rect" title=" " alt="" coords="5,1171,81,1197"/>
<area shape="rect" href="src_2fs_2stat_8c.html#ae9bbfad9a19a302b82cf82046bbb524e" title=" " alt="" coords="129,259,199,285"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2inode_8c.html#afa76e75f45af948cbb6e5da444038f40" title=" " alt="" coords="715,1373,762,1400"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2namei_8c.html#ae192f1ee0225a7a7c86385b7bf653ac2" title=" " alt="" coords="133,1171,195,1197"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2asm_2segment_8h.html#a8d241e819a095a0ad63eb07ca481e323" title=" " alt="" coords="247,208,345,235"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2kernel_8h.html#afc318b86ebf9e88f5af7ca7077098a7f" title=" " alt="" coords="249,259,343,285"/>
<area shape="rect" href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702" title=" " alt="" coords="417,259,469,285"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2fork_8c.html#abe18d0a2e79d311f52c8c127665239d6" title=" " alt="" coords="393,208,492,235"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2ll__rw__blk_8c.html#a628fc567a905186248e1ead5565f3b50" title=" " alt="" coords="540,5,641,32"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2buffer_8c.html#a008e777b9e9f7711d783bf16505bd714" title=" " alt="" coords="547,56,635,83"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2chr__drv_2tty__io_8c.html#ac90c768857a93aa43bc76c21efd88cde" title=" " alt="" coords="540,107,641,133"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2floppy_8c.html#a627138ff394a15374ddc80bba277550f" title=" " alt="" coords="545,157,636,184"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#acd2e1ded4bb6fce4500438bf928330f4" title=" " alt="" coords="715,233,763,260"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2hd_8c.html#a7b2099a07d66bdebdea911d947280854" title=" " alt="" coords="557,309,624,336"/>
<area shape="rect" href="flash_2Linux-0_811_2init_2main_8c.html#a2858154e2009b0e6e616f313177762bc" title=" " alt="" coords="569,259,612,285"/>
<area shape="rect" href="flash_2Linux-0_811_2mm_2memory_8c.html#a570fcb455a6b0459ada06e7825b783f2" title=" " alt="" coords="549,360,633,387"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2unistd_8h.html#a47a6ff5872f457ee230458137f2b2409" title=" " alt="" coords="560,411,621,437"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2blk__drv_2ramdisk_8c.html#a4257f1a08e61c6f803f7448371ac381f" title=" " alt="" coords="559,461,622,488"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2bitmap_8c.html#a3d90ed0df8a21fff7ae1e1a47053e406" title=" " alt="" coords="1322,1069,1413,1096"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2kernel_8h.html#ab43c5eded9a063f60e583332eaa73258" title=" " alt="" coords="1913,1285,1971,1312"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2mm_8h.html#a6b87a284a258fa3893dc88c0fcd6f610" title=" " alt="" coords="1779,1779,1865,1805"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2buffer_8c.html#a95df8a2e491bf4181e3d7b6ddfc755a3" title=" " alt="" coords="836,1627,919,1653"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2inode_8c.html#aef87a93dd139de38ca5b9baac78f4ccc" title=" " alt="" coords="1149,917,1265,944"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2inode_8c.html#a35a7c0ed9f4a491c42318c15ecefd197" title=" " alt="" coords="1158,1323,1257,1349"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#add6d90b147b8d600062919f0220600f4" title=" " alt="" coords="1632,1044,1711,1071"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2truncate_8c.html#a1697df39771f157846a3ef9f46327c23" title=" " alt="" coords="839,1500,915,1527"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2super_8c.html#a43f836df13a239d2197028d56018edba" title=" " alt="" coords="1473,1424,1560,1451"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2string_8h.html#a24267045b7b471321172ee7ac82f5158" title=" " alt="" coords="1479,993,1555,1020"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2kernel_8h.html#a929c48d2c61fe71be34a9cdf0ab04fcc" title=" " alt="" coords="2029,1412,2089,1439"/>
<area shape="rect" href="flash_2Linux-0_811_2kernel_2panic_8c.html#acc81aedafa96378bafb37b5bccbccb20" title=" " alt="" coords="2019,1285,2100,1312"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2fs_8h.html#af9add4ad497e3b9eae67e2cbf7cea45e" title=" " alt="" coords="1469,1728,1564,1755"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2inode_8c.html#a4e8b4c0a66f6ea10acdb053c4f4e8c79" title=" " alt="" coords="983,1323,1085,1349"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2buffer_8c.html#a96f49dc697e8292e946ba7680ebecf96" title=" " alt="" coords="1612,1463,1731,1489"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a8ee0eea1a206d256d223fd33292ddb5d" title=" " alt="" coords="1782,999,1862,1025"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2buffer_8c.html#ad78fac6715f3c28e0cf0522df36a111f" title=" " alt="" coords="1338,1525,1397,1552"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2buffer_8c.html#ad15c8296a5599c15736bb9383050eec7" title=" " alt="" coords="1485,1373,1548,1400"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2inode_8c.html#afa4df3c26552f5d09c7a0d6b080baf55" title=" " alt="" coords="1321,917,1413,944"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2inode_8c.html#a349a2c9da0dd73f8e8324143772650d6" title=" " alt="" coords="1313,968,1421,995"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2bitmap_8c.html#abdd0da83359d6f16a52320c44c41c526" title=" " alt="" coords="1322,1627,1413,1653"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2truncate_8c.html#a9127b9c1a0eae2a1f7d5ff723f5d3563" title=" " alt="" coords="993,1475,1075,1501"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2truncate_8c.html#af203200db3c89f320ff91fafa6ff4e98" title=" " alt="" coords="1170,1525,1245,1552"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2namei_8c.html#ae932b00aa69ebad7e231776a4da1fb01" title=" " alt="" coords="253,1171,339,1197"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2namei_8c.html#a13fdfb79df1bf5e5f9b0db0b484e26ed" title=" " alt="" coords="547,1272,634,1299"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2inode_8c.html#a78b297f206aacdb913d2db4db1ef6689" title=" " alt="" coords="567,955,614,981"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2namei_8c.html#a658203e2c0a6d0bf5f672b319e3880dd" title=" " alt="" coords="409,1120,476,1147"/>
<area shape="rect" href="flash_2Linux-0_811_2include_2asm_2segment_8h.html#a5f273be4f36ebf76067d04592954aaf4" title=" " alt="" coords="689,1120,788,1147"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2inode_8c.html#a608309a4a886522767be4646f5c709cc" title=" " alt="" coords="709,1880,768,1907"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2namei_8c.html#a9c1cc95fda9aa6082c0ae683b97eaaa3" title=" " alt="" coords="707,1829,770,1856"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2inode_8c.html#a233cbadcd057272f37322a707c908989" title=" " alt="" coords="967,867,1101,893"/>
<area shape="rect" href="flash_2Linux-0_811_2fs_2inode_8c.html#af3c9d35d7418d0b20df66b259199cedb" title=" " alt="" coords="1160,1019,1255,1045"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_7d71b6c457a61cbf03a04bfdc57b6110.html">fs</a></li><li class="navelem"><a class="el" href="src_2fs_2stat_8c.html">stat.c</a></li>
    <li class="footer">Generated on Thu Sep 14 2023 10:03:01 for linux by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
