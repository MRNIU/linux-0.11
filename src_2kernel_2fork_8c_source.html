<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linux: /home/runner/work/linux-0.11/linux-0.11/src/kernel/fork.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linux
   &#160;<span id="projectnumber">0.11</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('src_2kernel_2fork_8c_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">fork.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="src_2kernel_2fork_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  &#39;fork.c&#39; contains the help-routines for the &#39;fork&#39; system call (see also system_call.s),</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * and some misc functions(&#39;verify_area&#39;).Fork is rather simple,once you get the</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * hang of it.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * See &#39;mm/mm.c&#39;:&#39;copy_page_tables()&#39;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">/* ‘fork.c’ 中含有系统调用 &#39;fork&#39; 的辅助子程序(参见 system_call.s)，以及一些其他函数(&#39;verify_area&#39;).</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * 一旦你了解了 fork,就会发现它其实是非常简单的，但内存管理却有些难度。参见 &#39;mm/mm.c&#39; 中的</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * &#39;copy_page_tables()&#39;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include&lt;errno.h&gt;</span> <span class="comment">// 错误号头文件。包含系统中各种出错号。(Linus 从 MIXIX 中引进的)</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include&lt;linux/sched.h&gt;</span> <span class="comment">// 调度程序头文件，定义任务结构 task_struct、初始任务 0 的数据</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include&lt;linux/kernel.h&gt;</span>  <span class="comment">// 内核头文件。含有一些内核常用函数的原形定义</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include&lt;asm/segment.h&gt;</span> <span class="comment">// 段操作头文件。定义了有关段寄存器操作的嵌入式汇编函数</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include&lt;asm/system.h&gt;</span>  <span class="comment">// 系统头文件。定义了设置或修改描述符/中断门等的嵌入式汇编宏。</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#abe18d0a2e79d311f52c8c127665239d6">write_verify</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> address);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="src_2kernel_2fork_8c.html#a3f33947b2f4a1036cd2830fa11621c57">   20</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#a3f33947b2f4a1036cd2830fa11621c57">last_pid</a>=0;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// 进程空间区域写前验证函数。对当前进程的地址 addr 到 addr+size 这一段进程空间以页为单位执行</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// 写操作前的检测工作。若页面是只读的，则执行共享检验和复制页面操作。(写时复制)。</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="src_2kernel_2fork_8c.html#ad8efcba841fb222026f17dff526f0aa7">   23</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#ad8efcba841fb222026f17dff526f0aa7">verify_area</a>(<span class="keywordtype">void</span> *addr,<span class="keywordtype">int</span> size){</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702">start</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="code" href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702">start</a>=(<span class="keywordtype">unsigned</span> long)addr;  <span class="comment">// 将起始地址 start 调整为其所在页面的做辩解开始位置，同时</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  size+=<a class="code" href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702">start</a>&amp;0xfff;  <span class="comment">//  相应地调整验证区域大小</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702">start</a>&amp;=0xfffff000;  <span class="comment">// 此时 start 是当前进程空间中的线性地址</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702">start</a>+=<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a9dd1e6646ae18eb198ab5c9882b4f1a0">get_base</a>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#a326ff4e561c98dd1d2a23d43d0a42ab6">ldt</a>[2]); <span class="comment">// 此时 start 变成整个线性空间中的地址位置。</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">while</span>(size&gt;0){</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    size-=4096;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#abe18d0a2e79d311f52c8c127665239d6">write_verify</a>(<a class="code" href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702">start</a>);  <span class="comment">// 写页面验证。若页面不可写，则复制页面。</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702">start</a>+=4096;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// 设置新任务代码和数据段基址、限长并复制页表。nr 为新任务号；p 是新任务数据结构的指针。</span></div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="src_2kernel_2fork_8c.html#a83662a2300404942511d99c80128deb1">   37</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#a83662a2300404942511d99c80128deb1">copy_mem</a>(<span class="keywordtype">int</span> nr,<span class="keyword">struct</span> <a class="code" href="structtask__struct.html">task_struct</a> *p){</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> old_data_base,new_data_base,data_limit;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> old_code_base,new_code_base,code_limit;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  code_limit=<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a17e07a3b0c01ae08bc0fe1136c24a092">get_limit</a>(0x0f); <span class="comment">// 取局部描述符表中代码段描述符项中段限长</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  data_limit=<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a17e07a3b0c01ae08bc0fe1136c24a092">get_limit</a>(0x17); <span class="comment">// 取局部描述符表中数据段描述符项中段限长</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  old_code_base=<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a9dd1e6646ae18eb198ab5c9882b4f1a0">get_base</a>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#a326ff4e561c98dd1d2a23d43d0a42ab6">ldt</a>[1]);  <span class="comment">// 取原代码段基址</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  old_data_base=<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a9dd1e6646ae18eb198ab5c9882b4f1a0">get_base</a>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#a326ff4e561c98dd1d2a23d43d0a42ab6">ldt</a>[2]);  <span class="comment">// 取原数据段基址</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">if</span>(old_data_base!= old_code_base) <span class="comment">// 0.11 版不支持代码和数据段分立的情况</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="flash_2Linux-0_811_2include_2linux_2kernel_8h.html#ab43c5eded9a063f60e583332eaa73258">panic</a>(<span class="stringliteral">&quot;We don&#39;t support separate I&amp;D&quot;</span>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">if</span>(data_limit&lt;code_limit) <span class="comment">// 如果数据段长度 &lt; 代码段长度也不对</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="flash_2Linux-0_811_2include_2linux_2kernel_8h.html#ab43c5eded9a063f60e583332eaa73258">panic</a>(<span class="stringliteral">&quot;Bad data_limit&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  new_data_base=new_code_base=nr*0x4000000; <span class="comment">// 新基址=任务号*64 MB(任务大小)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a24d9b9a967501adbc9ef96dde3ae3cbd">start_code</a>=new_code_base;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a9887960d03859332cb310a3e349868ba">set_base</a>(p-&gt;<a class="code" href="structtask__struct.html#a326ff4e561c98dd1d2a23d43d0a42ab6">ldt</a>[1],new_code_base);  <span class="comment">// 设置代码段描述符中基址域</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a9887960d03859332cb310a3e349868ba">set_base</a>(p-&gt;<a class="code" href="structtask__struct.html#a326ff4e561c98dd1d2a23d43d0a42ab6">ldt</a>[2],new_data_base);  <span class="comment">// 设置数据段描述符中基址域</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// 设置新进程的页目录表项和页表项。即把新进程的线性地址内存页对应到实际物理地址内存页面上。</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// 由于 Linux 采用了写时复制(Cppy on Write)技术，因此这里仅为新进程设置了自己的页目录表项</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// 和页表项，而没有实际为新进程分配物理内存页面。此时新进程与其父进程共享所有物理页面。若出错</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// 则释放申请的页表项。</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a3ff1fa1f4d832c7358ba7a038dbac76c">copy_page_tables</a>(old_data_base,new_data_base,data_limit)){</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a235add1ba6e02ce735d70348d51b25da">free_page_tables</a>(new_data_base,data_limit);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="flash_2Linux-0_811_2include_2errno_8h.html#a6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">// 复制进程。其中参数 none 是 system_call.s 中调用 sys_call_table 时压入堆栈的返回地址。</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> *  Ok,this is the main fork-routine.It copies the system process information (task[nr])</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> * and sets up the necessary registers.It also copies the data segment in it&#39;s entirety.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">/* 下面是主要的 fork 子程序。它复制系统进程信息(task[n])并且设置必要的寄存器。</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> * 它还整个地复制数据段。</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="src_2kernel_2fork_8c.html#ab154f2aa621bc4a2a554496a7eaa59ab">   71</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#ab154f2aa621bc4a2a554496a7eaa59ab">copy_process</a>(<span class="keywordtype">int</span> nr,<span class="keywordtype">long</span> ebp,<span class="keywordtype">long</span> edi,<span class="keywordtype">long</span> esi,<span class="keywordtype">long</span> gs,<span class="keywordtype">long</span> none,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                 <span class="keywordtype">long</span> ebx,<span class="keywordtype">long</span> ecx,<span class="keywordtype">long</span> edx,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                 <span class="keywordtype">long</span> fs,<span class="keywordtype">long</span> es,<span class="keywordtype">long</span> ds,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                 <span class="keywordtype">long</span> eip,<span class="keywordtype">long</span> cs,<span class="keywordtype">long</span> eflags,<span class="keywordtype">long</span> esp,<span class="keywordtype">long</span> ss){</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keyword">struct </span><a class="code" href="structtask__struct.html">task_struct</a> *p;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keyword">struct </span><a class="code" href="structfile.html">file</a> *f;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  p=(<span class="keyword">struct </span><a class="code" href="structtask__struct.html">task_struct</a>*)<a class="code" href="flash_2Linux-0_811_2include_2linux_2mm_8h.html#af5beb0578c75971eb353cd8a67e9c042">get_free_page</a>(); <span class="comment">// 为新任务数据结构分配内存</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">if</span>(!p)  <span class="keywordflow">return</span> -<a class="code" href="flash_2Linux-0_811_2include_2errno_8h.html#af0fac1cea1165b4debec7f686edf3313">EAGAIN</a>; <span class="comment">// 如果内存分配出错，则返回出错码并退出</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a32ae6a90bd92bba7a7d2103b2b0662d8">task</a>[nr]=p; <span class="comment">// 将新任务指针放入数组中，其中 nr 为任务号</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  *p= *<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>; <span class="comment">// NOTE! this doesn&#39;t copy the supervisor stack</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                <span class="comment">// 注意！这样做不会复制超级用户的堆栈 只复制当前进程内容</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a7c764a1b0218921014431825397cdce8">state</a>=<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a797095919d5e24e5dc00c4d0bbc7ec31">TASK_UNINTERRUPTIBLE</a>;  <span class="comment">// 将新进程的状态先置为不可中断等待状态</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a192ab89a0e8b299ff3fca4931e331667">pid</a>=<a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#a3f33947b2f4a1036cd2830fa11621c57">last_pid</a>;  <span class="comment">// 新进程号。由前面调用 find_empty_process() 得到</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a889eead58452db4f8a717d529db3476f">father</a>=<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#a192ab89a0e8b299ff3fca4931e331667">pid</a>; <span class="comment">// 设置父进程号</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#ae4e1fb3352913d7090328fb14a5f1ab6">counter</a>=p-&gt;<a class="code" href="structtask__struct.html#a8193f5ec2b16adca8548c1933ea32ac4">priority</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a52bf129480ad1720d6672e94a8736b56">signal</a>=0;  <span class="comment">// 信号位图置 0</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a0e5b73ccd6d17da05b7d7b4f12840dd7">alarm</a>=0; <span class="comment">// 进程的领导权是不能继承的</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a27d1eeb29875216c39bb586fb0b3351e">leader</a>=0;  <span class="comment">// process leadership doesn&#39;t inherit</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#ac67536267a42feff0b76cd421f3b7ba5">utime</a>=p-&gt;<a class="code" href="structtask__struct.html#aa93ba7dd90be4a36c8f99605d0c1c267">stime</a>=0; <span class="comment">// 初始化用户态时间和核心时间</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#abe96abb8ca23fc1652ae702a8d4ee0f1">cutime</a>=p-&gt;<a class="code" href="structtask__struct.html#ad7708e623dbbdec46f098cb287ba916f">cstime</a>=0;  <span class="comment">// 初始化子进程用户态和核心态时间</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5bc65cf51b00bf240ba7a6e33b0dc557">start_time</a>=<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a37aca3305753442605b0762afa99a07e">jiffies</a>;  <span class="comment">// 当前滴答数时间</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a2ab212d44ec13115091bdfea25c40b2d">back_link</a>=0; <span class="comment">// 以下设置任务状态段 TSS 所需的数据(参见列表后说明)</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a5278763218530acea6ed5eca281da2c7">esp0</a>=<a class="code" href="flash_2Linux-0_811_2include_2a_8out_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>+(long)p;  <span class="comment">// 堆栈指针。由于是给任务结构 p 分配了 1 页新内存，所以此时</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                  <span class="comment">// esp0 正好指向该页顶端. ss0:esp0 用于作为程序在内核态</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                  <span class="comment">// 执行时的堆栈</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a2951d2f693e4bc672ef197e36be51187">ss0</a>=0x10;  <span class="comment">// 堆栈段选择符(内核数据段)</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#ab71e63c68ca8ca2f4fa8f9740091f387">eip</a>=eip; <span class="comment">// 指令代码指针</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#aba9d2203aec95e7b103a54f61a7f26be">eflags</a>=eflags; <span class="comment">// 标志寄存器</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a8ca4b066e53d0ecf1a158cfaa724de0e">eax</a>=0; <span class="comment">// 这是当 forK() 返回时，新进程会返回 0 的原因所在。</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a163f0aeea4b826476567291c0550603d">ecx</a>=ecx;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a44f1cf88dc485efc46c280331bee2f15">edx</a>=edx;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#aa564439ea1eabeba14b0e8b7c0b4cba5">ebx</a>=ebx;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#aa4f02717786d9775affbb21e991ff6e5">esp</a>=esp; <span class="comment">// 新进程完全复制了父进程的堆栈内容，因此要求 task0 的堆栈比较 &quot;干净&quot;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a265cb916696366cd829321a36281fcff">ebp</a>=ebp;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#ab17663a45d8fac3e57549f30ffdfc8c6">esi</a>=esi;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#afca380fb2cf2efd7b933865ee3287faf">edi</a>=edi;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#aeaf5c06a6b150bd3950ea232fd9e7ad2">es</a>=es&amp;0xffff;  <span class="comment">// 段寄存器仅 16 位有效</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a690779f84552e81c65f7fe7f64509ae3">cs</a>=cs&amp;0xffff;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a2a085ec11d3926d2fd6a26860cc5eafa">ss</a>=ss&amp;0xffff;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a30804603b60c2c45a50672c138b8b210">ds</a>=ds&amp;0xffff;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#aa8df65f6223dbabbb80fd77639758ff9">fs</a>=fs&amp;0xffff;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a8c413a9f9fba57401c6637b654e5afb7">gs</a>=gs&amp;0xffff;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a1c7bbe6f65933eb827d7fd0b444cfbb0">ldt</a>=<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#ad409b6004d0298c9d562e40fa00a9a30">_LDT</a>(nr);  <span class="comment">// 该新任务 nr 的局部描述符表选择符(LDT 的描述符在 GDT 中)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#ac04a5548296792b2958d77187279ed5f">trace_bitmap</a>=0x80000000; <span class="comment">// (高 16 位有效)</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a4a720faae9986c1917541956019c8a3b">last_task_used_math</a>==<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>)  <span class="comment">// 若当前任务使用了协处理器，就保存其上下文</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    __asm__(<span class="stringliteral">&quot;clts;fnsave %0&quot;</span>::<span class="stringliteral">&quot;m&quot;</span>(p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>.<a class="code" href="structtss__struct.html#a58edc7ddd17400641060790ec8c41be2">i387</a>));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">// 设置新任务的代码和数据段基址、限长并复制页表。如果出错(返回值不是 0)，则复位任务数组中相应项</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">// 并释放为该新任务分配的内存页</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#a83662a2300404942511d99c80128deb1">copy_mem</a>(nr,p)){ <span class="comment">// 返回不为 0 则表示出错</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a32ae6a90bd92bba7a7d2103b2b0662d8">task</a>[nr]=<a class="code" href="flash_2Linux-0_811_2include_2linux_2fs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="flash_2Linux-0_811_2include_2linux_2mm_8h.html#a6b87a284a258fa3893dc88c0fcd6f610">free_page</a>((<span class="keywordtype">long</span>)p);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="flash_2Linux-0_811_2include_2errno_8h.html#af0fac1cea1165b4debec7f686edf3313">EAGAIN</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="flash_2Linux-0_811_2include_2linux_2fs_8h.html#a326ba885b33e0ac094fec455a1ec30b3">NR_OPEN</a>;i++)  <span class="comment">// 若父进程中有文件是打开的，则将对应文件打开次数增 1</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span>(f=p-&gt;<a class="code" href="structtask__struct.html#af92b36c90c0636553c690c20ecc9553e">filp</a>[i])</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      f-&gt;<a class="code" href="structfile.html#aa9793ad16dd2b88ad0d76cd782b0d2b7">f_count</a>++;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#a66b96e2cff9937ecdba35d1787a6a099">pwd</a>)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#a66b96e2cff9937ecdba35d1787a6a099">pwd</a>-&gt;<a class="code" href="structm__inode.html#a2a639e88f4a46ff1bff2078aef2f6839">i_count</a>++;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#a7e465a232e068e5bf74d8b389b8e82ed">root</a>)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#a7e465a232e068e5bf74d8b389b8e82ed">root</a>-&gt;<a class="code" href="structm__inode.html#a2a639e88f4a46ff1bff2078aef2f6839">i_count</a>++;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#ae07dc9ad85faa82c21f0280346eee331">executable</a>)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a>-&gt;<a class="code" href="structtask__struct.html#ae07dc9ad85faa82c21f0280346eee331">executable</a>-&gt;<a class="code" href="structm__inode.html#a2a639e88f4a46ff1bff2078aef2f6839">i_count</a>++;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">// 在 GDT 中设置新任务的 TSS 和 LDT 描述符项，参见 include/asm/system.h 2222-2222</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">// 在任务切换时，任务寄存器哦 tr 由 CPU 自动加载。</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="flash_2Linux-0_811_2include_2asm_2system_8h.html#a96702af0c49d089dea06401ef7c35603">set_tss_desc</a>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2head_8h.html#a3e85239bce7eee478410603d53e53218">gdt</a>+(nr&lt;&lt;1)+<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#aefe0cea87f00996e61511690b95362aa">FIRST_TSS_ENTRY</a>,&amp;(p-&gt;<a class="code" href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">tss</a>));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="flash_2Linux-0_811_2include_2asm_2system_8h.html#a2c14e0b2544e442c0ab14172a8ee869d">set_ldt_desc</a>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2head_8h.html#a3e85239bce7eee478410603d53e53218">gdt</a>+(nr&lt;&lt;1)+<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#af64191dd71668816b0163a4f16f01946">FIRST_LDT_ENTRY</a>,&amp;(p-&gt;<a class="code" href="structtask__struct.html#a326ff4e561c98dd1d2a23d43d0a42ab6">ldt</a>));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  p-&gt;<a class="code" href="structtask__struct.html#a7c764a1b0218921014431825397cdce8">state</a>=<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a17e3f99a030e5dfefb8f9815600e3fed">TASK_RUNNING</a>;  <span class="comment">// do this last,just in case 最后再将新任务设置成可运行状态，以防万一</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#a3f33947b2f4a1036cd2830fa11621c57">last_pid</a>;  <span class="comment">// 返回新进程号(与任务号是不同的)</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">// 为新进程取得不重复的进程号 last_pid ,并返回在任务数组中的任务号(数组 index)</span></div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="src_2kernel_2fork_8c.html#a4f5d31cd1857855b708465812fa64642">  143</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#a4f5d31cd1857855b708465812fa64642">find_empty_process</a>(<span class="keywordtype">void</span>){</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;repeat:</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">if</span>((++<a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#a3f33947b2f4a1036cd2830fa11621c57">last_pid</a>)&lt;0)  <a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#a3f33947b2f4a1036cd2830fa11621c57">last_pid</a>=1;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a88a8e8596ba6eca6449e368319c9c73d">NR_TASKS</a>;i++)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a32ae6a90bd92bba7a7d2103b2b0662d8">task</a>[i] &amp;&amp; <a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a32ae6a90bd92bba7a7d2103b2b0662d8">task</a>[i]-&gt;<a class="code" href="structtask__struct.html#a192ab89a0e8b299ff3fca4931e331667">pid</a>==<a class="code" href="flash_2Linux-0_811_2kernel_2fork_8c.html#a3f33947b2f4a1036cd2830fa11621c57">last_pid</a>) <span class="keywordflow">goto</span> repeat;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">for</span>(i=1;i&lt;<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a88a8e8596ba6eca6449e368319c9c73d">NR_TASKS</a>;i++) <span class="comment">// 任务 0 排除在外</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a32ae6a90bd92bba7a7d2103b2b0662d8">task</a>[i])</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">return</span> -<a class="code" href="flash_2Linux-0_811_2include_2errno_8h.html#af0fac1cea1165b4debec7f686edf3313">EAGAIN</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2a_8out_8h_html_a7d467c1d283fdfa1f2081ba1e0d01b6e"><div class="ttname"><a href="flash_2Linux-0_811_2include_2a_8out_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a></div><div class="ttdeci">#define PAGE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2a_8out_8h_source.html#l00092">a.out.h:92</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2asm_2system_8h_html_a2c14e0b2544e442c0ab14172a8ee869d"><div class="ttname"><a href="flash_2Linux-0_811_2include_2asm_2system_8h.html#a2c14e0b2544e442c0ab14172a8ee869d">set_ldt_desc</a></div><div class="ttdeci">#define set_ldt_desc(n, addr)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2asm_2system_8h_source.html#l00066">system.h:66</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2asm_2system_8h_html_a96702af0c49d089dea06401ef7c35603"><div class="ttname"><a href="flash_2Linux-0_811_2include_2asm_2system_8h.html#a96702af0c49d089dea06401ef7c35603">set_tss_desc</a></div><div class="ttdeci">#define set_tss_desc(n, addr)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2asm_2system_8h_source.html#l00065">system.h:65</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2errno_8h_html_a6a05c923dad0c1208043e9c20a58c8e5"><div class="ttname"><a href="flash_2Linux-0_811_2include_2errno_8h.html#a6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a></div><div class="ttdeci">#define ENOMEM</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2errno_8h_source.html#l00031">errno.h:31</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2errno_8h_html_af0fac1cea1165b4debec7f686edf3313"><div class="ttname"><a href="flash_2Linux-0_811_2include_2errno_8h.html#af0fac1cea1165b4debec7f686edf3313">EAGAIN</a></div><div class="ttdeci">#define EAGAIN</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2errno_8h_source.html#l00030">errno.h:30</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2fs_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2fs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00052">fs.h:52</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2fs_8h_html_a326ba885b33e0ac094fec455a1ec30b3"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2fs_8h.html#a326ba885b33e0ac094fec455a1ec30b3">NR_OPEN</a></div><div class="ttdeci">#define NR_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00043">fs.h:43</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2head_8h_html_a3e85239bce7eee478410603d53e53218"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2head_8h.html#a3e85239bce7eee478410603d53e53218">gdt</a></div><div class="ttdeci">desc_table gdt</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2head_8h_source.html#l00009">head.h:9</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2kernel_8h_html_ab43c5eded9a063f60e583332eaa73258"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2kernel_8h.html#ab43c5eded9a063f60e583332eaa73258">panic</a></div><div class="ttdeci">volatile void panic(const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2panic_8c_source.html#l00018">panic.c:18</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2mm_8h_html_a6b87a284a258fa3893dc88c0fcd6f610"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2mm_8h.html#a6b87a284a258fa3893dc88c0fcd6f610">free_page</a></div><div class="ttdeci">void free_page(unsigned long addr)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2mm_2memory_8c_source.html#l00089">memory.c:89</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2mm_8h_html_af5beb0578c75971eb353cd8a67e9c042"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2mm_8h.html#af5beb0578c75971eb353cd8a67e9c042">get_free_page</a></div><div class="ttdeci">unsigned long get_free_page(void)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2mm_2memory_8c_source.html#l00063">memory.c:63</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a17e07a3b0c01ae08bc0fe1136c24a092"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a17e07a3b0c01ae08bc0fe1136c24a092">get_limit</a></div><div class="ttdeci">#define get_limit(segment)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00251">sched.h:251</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a17e3f99a030e5dfefb8f9815600e3fed"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a17e3f99a030e5dfefb8f9815600e3fed">TASK_RUNNING</a></div><div class="ttdeci">#define TASK_RUNNING</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00019">sched.h:19</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a235add1ba6e02ce735d70348d51b25da"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a235add1ba6e02ce735d70348d51b25da">free_page_tables</a></div><div class="ttdeci">int free_page_tables(unsigned long from, unsigned long size)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2mm_2memory_8c_source.html#l00105">memory.c:105</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a32ae6a90bd92bba7a7d2103b2b0662d8"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a32ae6a90bd92bba7a7d2103b2b0662d8">task</a></div><div class="ttdeci">struct task_struct * task[NR_TASKS]</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2sched_8c_source.html#l00065">sched.c:65</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a37aca3305753442605b0762afa99a07e"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a37aca3305753442605b0762afa99a07e">jiffies</a></div><div class="ttdeci">long volatile jiffies</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2sched_8c_source.html#l00060">sched.c:60</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a3ff1fa1f4d832c7358ba7a038dbac76c"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a3ff1fa1f4d832c7358ba7a038dbac76c">copy_page_tables</a></div><div class="ttdeci">int copy_page_tables(unsigned long from, unsigned long to, long size)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2mm_2memory_8c_source.html#l00150">memory.c:150</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a476ec09a598028a09942c2233aa5127e"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a476ec09a598028a09942c2233aa5127e">current</a></div><div class="ttdeci">struct task_struct * current</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2sched_8c_source.html#l00062">sched.c:62</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a4a720faae9986c1917541956019c8a3b"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a4a720faae9986c1917541956019c8a3b">last_task_used_math</a></div><div class="ttdeci">struct task_struct * last_task_used_math</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2sched_8c_source.html#l00063">sched.c:63</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a797095919d5e24e5dc00c4d0bbc7ec31"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a797095919d5e24e5dc00c4d0bbc7ec31">TASK_UNINTERRUPTIBLE</a></div><div class="ttdeci">#define TASK_UNINTERRUPTIBLE</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00021">sched.h:21</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a88a8e8596ba6eca6449e368319c9c73d"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a88a8e8596ba6eca6449e368319c9c73d">NR_TASKS</a></div><div class="ttdeci">#define NR_TASKS</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00004">sched.h:4</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a9887960d03859332cb310a3e349868ba"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a9887960d03859332cb310a3e349868ba">set_base</a></div><div class="ttdeci">#define set_base(ldt, base)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00217">sched.h:217</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_a9dd1e6646ae18eb198ab5c9882b4f1a0"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#a9dd1e6646ae18eb198ab5c9882b4f1a0">get_base</a></div><div class="ttdeci">#define get_base(ldt)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00249">sched.h:249</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_ad409b6004d0298c9d562e40fa00a9a30"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#ad409b6004d0298c9d562e40fa00a9a30">_LDT</a></div><div class="ttdeci">#define _LDT(n)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00158">sched.h:158</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_aefe0cea87f00996e61511690b95362aa"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#aefe0cea87f00996e61511690b95362aa">FIRST_TSS_ENTRY</a></div><div class="ttdeci">#define FIRST_TSS_ENTRY</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00155">sched.h:155</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2include_2linux_2sched_8h_html_af64191dd71668816b0163a4f16f01946"><div class="ttname"><a href="flash_2Linux-0_811_2include_2linux_2sched_8h.html#af64191dd71668816b0163a4f16f01946">FIRST_LDT_ENTRY</a></div><div class="ttdeci">#define FIRST_LDT_ENTRY</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00156">sched.h:156</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2init_2main_8c_html_aedc96a40e844bc2efc8bbef1b0782702"><div class="ttname"><a href="flash_2Linux-0_811_2init_2main_8c.html#aedc96a40e844bc2efc8bbef1b0782702">start</a></div><div class="ttdeci">void start(void)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2init_2main_8c_source.html#l00104">main.c:104</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2kernel_2fork_8c_html_a3f33947b2f4a1036cd2830fa11621c57"><div class="ttname"><a href="flash_2Linux-0_811_2kernel_2fork_8c.html#a3f33947b2f4a1036cd2830fa11621c57">last_pid</a></div><div class="ttdeci">long last_pid</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2fork_8c_source.html#l00022">fork.c:22</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2kernel_2fork_8c_html_a4f5d31cd1857855b708465812fa64642"><div class="ttname"><a href="flash_2Linux-0_811_2kernel_2fork_8c.html#a4f5d31cd1857855b708465812fa64642">find_empty_process</a></div><div class="ttdeci">int find_empty_process(void)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2fork_8c_source.html#l00136">fork.c:136</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2kernel_2fork_8c_html_a83662a2300404942511d99c80128deb1"><div class="ttname"><a href="flash_2Linux-0_811_2kernel_2fork_8c.html#a83662a2300404942511d99c80128deb1">copy_mem</a></div><div class="ttdeci">int copy_mem(int nr, struct task_struct *p)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2fork_8c_source.html#l00039">fork.c:39</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2kernel_2fork_8c_html_ab154f2aa621bc4a2a554496a7eaa59ab"><div class="ttname"><a href="flash_2Linux-0_811_2kernel_2fork_8c.html#ab154f2aa621bc4a2a554496a7eaa59ab">copy_process</a></div><div class="ttdeci">int copy_process(int nr, long ebp, long edi, long esi, long gs, long none, long ebx, long ecx, long edx, long fs, long es, long ds, long eip, long cs, long eflags, long esp, long ss)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2fork_8c_source.html#l00069">fork.c:69</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2kernel_2fork_8c_html_abe18d0a2e79d311f52c8c127665239d6"><div class="ttname"><a href="flash_2Linux-0_811_2kernel_2fork_8c.html#abe18d0a2e79d311f52c8c127665239d6">write_verify</a></div><div class="ttdeci">void write_verify(unsigned long address)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2mm_2memory_8c_source.html#l00261">memory.c:261</a></div></div>
<div class="ttc" id="aflash_2Linux-0_811_2kernel_2fork_8c_html_ad8efcba841fb222026f17dff526f0aa7"><div class="ttname"><a href="flash_2Linux-0_811_2kernel_2fork_8c.html#ad8efcba841fb222026f17dff526f0aa7">verify_area</a></div><div class="ttdeci">void verify_area(void *addr, int size)</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2kernel_2fork_8c_source.html#l00024">fork.c:24</a></div></div>
<div class="ttc" id="astructfile_html"><div class="ttname"><a href="structfile.html">file</a></div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00116">fs.h:116</a></div></div>
<div class="ttc" id="astructfile_html_aa9793ad16dd2b88ad0d76cd782b0d2b7"><div class="ttname"><a href="structfile.html#aa9793ad16dd2b88ad0d76cd782b0d2b7">file::f_count</a></div><div class="ttdeci">unsigned short f_count</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00119">fs.h:119</a></div></div>
<div class="ttc" id="astructm__inode_html_a2a639e88f4a46ff1bff2078aef2f6839"><div class="ttname"><a href="structm__inode.html#a2a639e88f4a46ff1bff2078aef2f6839">m_inode::i_count</a></div><div class="ttdeci">unsigned short i_count</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2fs_8h_source.html#l00107">fs.h:107</a></div></div>
<div class="ttc" id="astructtask__struct_html"><div class="ttname"><a href="structtask__struct.html">task_struct</a></div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00080">sched.h:80</a></div></div>
<div class="ttc" id="astructtask__struct_html_a0e5b73ccd6d17da05b7d7b4f12840dd7"><div class="ttname"><a href="structtask__struct.html#a0e5b73ccd6d17da05b7d7b4f12840dd7">task_struct::alarm</a></div><div class="ttdeci">long alarm</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00094">sched.h:94</a></div></div>
<div class="ttc" id="astructtask__struct_html_a192ab89a0e8b299ff3fca4931e331667"><div class="ttname"><a href="structtask__struct.html#a192ab89a0e8b299ff3fca4931e331667">task_struct::pid</a></div><div class="ttdeci">long pid</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00091">sched.h:91</a></div></div>
<div class="ttc" id="astructtask__struct_html_a24d9b9a967501adbc9ef96dde3ae3cbd"><div class="ttname"><a href="structtask__struct.html#a24d9b9a967501adbc9ef96dde3ae3cbd">task_struct::start_code</a></div><div class="ttdeci">unsigned long start_code</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00090">sched.h:90</a></div></div>
<div class="ttc" id="astructtask__struct_html_a27d1eeb29875216c39bb586fb0b3351e"><div class="ttname"><a href="structtask__struct.html#a27d1eeb29875216c39bb586fb0b3351e">task_struct::leader</a></div><div class="ttdeci">long leader</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00091">sched.h:91</a></div></div>
<div class="ttc" id="astructtask__struct_html_a326ff4e561c98dd1d2a23d43d0a42ab6"><div class="ttname"><a href="structtask__struct.html#a326ff4e561c98dd1d2a23d43d0a42ab6">task_struct::ldt</a></div><div class="ttdeci">struct desc_struct ldt[3]</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00104">sched.h:106</a></div></div>
<div class="ttc" id="astructtask__struct_html_a52bf129480ad1720d6672e94a8736b56"><div class="ttname"><a href="structtask__struct.html#a52bf129480ad1720d6672e94a8736b56">task_struct::signal</a></div><div class="ttdeci">long signal</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00085">sched.h:85</a></div></div>
<div class="ttc" id="astructtask__struct_html_a5bc65cf51b00bf240ba7a6e33b0dc557"><div class="ttname"><a href="structtask__struct.html#a5bc65cf51b00bf240ba7a6e33b0dc557">task_struct::start_time</a></div><div class="ttdeci">long start_time</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00095">sched.h:95</a></div></div>
<div class="ttc" id="astructtask__struct_html_a5d739e2cde5e8828a687c539076535b5"><div class="ttname"><a href="structtask__struct.html#a5d739e2cde5e8828a687c539076535b5">task_struct::tss</a></div><div class="ttdeci">struct tss_struct tss</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00104">sched.h:108</a></div></div>
<div class="ttc" id="astructtask__struct_html_a66b96e2cff9937ecdba35d1787a6a099"><div class="ttname"><a href="structtask__struct.html#a66b96e2cff9937ecdba35d1787a6a099">task_struct::pwd</a></div><div class="ttdeci">struct m_inode * pwd</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00100">sched.h:100</a></div></div>
<div class="ttc" id="astructtask__struct_html_a7c764a1b0218921014431825397cdce8"><div class="ttname"><a href="structtask__struct.html#a7c764a1b0218921014431825397cdce8">task_struct::state</a></div><div class="ttdeci">long state</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00082">sched.h:82</a></div></div>
<div class="ttc" id="astructtask__struct_html_a7e465a232e068e5bf74d8b389b8e82ed"><div class="ttname"><a href="structtask__struct.html#a7e465a232e068e5bf74d8b389b8e82ed">task_struct::root</a></div><div class="ttdeci">struct m_inode * root</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00101">sched.h:101</a></div></div>
<div class="ttc" id="astructtask__struct_html_a8193f5ec2b16adca8548c1933ea32ac4"><div class="ttname"><a href="structtask__struct.html#a8193f5ec2b16adca8548c1933ea32ac4">task_struct::priority</a></div><div class="ttdeci">long priority</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00084">sched.h:84</a></div></div>
<div class="ttc" id="astructtask__struct_html_a889eead58452db4f8a717d529db3476f"><div class="ttname"><a href="structtask__struct.html#a889eead58452db4f8a717d529db3476f">task_struct::father</a></div><div class="ttdeci">long father</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00091">sched.h:91</a></div></div>
<div class="ttc" id="astructtask__struct_html_aa93ba7dd90be4a36c8f99605d0c1c267"><div class="ttname"><a href="structtask__struct.html#aa93ba7dd90be4a36c8f99605d0c1c267">task_struct::stime</a></div><div class="ttdeci">long stime</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00095">sched.h:95</a></div></div>
<div class="ttc" id="astructtask__struct_html_abe96abb8ca23fc1652ae702a8d4ee0f1"><div class="ttname"><a href="structtask__struct.html#abe96abb8ca23fc1652ae702a8d4ee0f1">task_struct::cutime</a></div><div class="ttdeci">long cutime</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00095">sched.h:95</a></div></div>
<div class="ttc" id="astructtask__struct_html_ac67536267a42feff0b76cd421f3b7ba5"><div class="ttname"><a href="structtask__struct.html#ac67536267a42feff0b76cd421f3b7ba5">task_struct::utime</a></div><div class="ttdeci">long utime</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00095">sched.h:95</a></div></div>
<div class="ttc" id="astructtask__struct_html_ad7708e623dbbdec46f098cb287ba916f"><div class="ttname"><a href="structtask__struct.html#ad7708e623dbbdec46f098cb287ba916f">task_struct::cstime</a></div><div class="ttdeci">long cstime</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00095">sched.h:95</a></div></div>
<div class="ttc" id="astructtask__struct_html_ae07dc9ad85faa82c21f0280346eee331"><div class="ttname"><a href="structtask__struct.html#ae07dc9ad85faa82c21f0280346eee331">task_struct::executable</a></div><div class="ttdeci">struct m_inode * executable</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00102">sched.h:102</a></div></div>
<div class="ttc" id="astructtask__struct_html_ae4e1fb3352913d7090328fb14a5f1ab6"><div class="ttname"><a href="structtask__struct.html#ae4e1fb3352913d7090328fb14a5f1ab6">task_struct::counter</a></div><div class="ttdeci">long counter</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00083">sched.h:83</a></div></div>
<div class="ttc" id="astructtask__struct_html_af92b36c90c0636553c690c20ecc9553e"><div class="ttname"><a href="structtask__struct.html#af92b36c90c0636553c690c20ecc9553e">task_struct::filp</a></div><div class="ttdeci">struct file * filp[NR_OPEN]</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00104">sched.h:104</a></div></div>
<div class="ttc" id="astructtss__struct_html_a163f0aeea4b826476567291c0550603d"><div class="ttname"><a href="structtss__struct.html#a163f0aeea4b826476567291c0550603d">tss_struct::ecx</a></div><div class="ttdeci">long ecx</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00064">sched.h:64</a></div></div>
<div class="ttc" id="astructtss__struct_html_a1c7bbe6f65933eb827d7fd0b444cfbb0"><div class="ttname"><a href="structtss__struct.html#a1c7bbe6f65933eb827d7fd0b444cfbb0">tss_struct::ldt</a></div><div class="ttdeci">long ldt</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00075">sched.h:75</a></div></div>
<div class="ttc" id="astructtss__struct_html_a265cb916696366cd829321a36281fcff"><div class="ttname"><a href="structtss__struct.html#a265cb916696366cd829321a36281fcff">tss_struct::ebp</a></div><div class="ttdeci">long ebp</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00066">sched.h:66</a></div></div>
<div class="ttc" id="astructtss__struct_html_a2951d2f693e4bc672ef197e36be51187"><div class="ttname"><a href="structtss__struct.html#a2951d2f693e4bc672ef197e36be51187">tss_struct::ss0</a></div><div class="ttdeci">long ss0</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00056">sched.h:56</a></div></div>
<div class="ttc" id="astructtss__struct_html_a2a085ec11d3926d2fd6a26860cc5eafa"><div class="ttname"><a href="structtss__struct.html#a2a085ec11d3926d2fd6a26860cc5eafa">tss_struct::ss</a></div><div class="ttdeci">long ss</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00071">sched.h:71</a></div></div>
<div class="ttc" id="astructtss__struct_html_a2ab212d44ec13115091bdfea25c40b2d"><div class="ttname"><a href="structtss__struct.html#a2ab212d44ec13115091bdfea25c40b2d">tss_struct::back_link</a></div><div class="ttdeci">long back_link</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00054">sched.h:54</a></div></div>
<div class="ttc" id="astructtss__struct_html_a30804603b60c2c45a50672c138b8b210"><div class="ttname"><a href="structtss__struct.html#a30804603b60c2c45a50672c138b8b210">tss_struct::ds</a></div><div class="ttdeci">long ds</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00072">sched.h:72</a></div></div>
<div class="ttc" id="astructtss__struct_html_a44f1cf88dc485efc46c280331bee2f15"><div class="ttname"><a href="structtss__struct.html#a44f1cf88dc485efc46c280331bee2f15">tss_struct::edx</a></div><div class="ttdeci">long edx</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00064">sched.h:64</a></div></div>
<div class="ttc" id="astructtss__struct_html_a5278763218530acea6ed5eca281da2c7"><div class="ttname"><a href="structtss__struct.html#a5278763218530acea6ed5eca281da2c7">tss_struct::esp0</a></div><div class="ttdeci">long esp0</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00055">sched.h:55</a></div></div>
<div class="ttc" id="astructtss__struct_html_a58edc7ddd17400641060790ec8c41be2"><div class="ttname"><a href="structtss__struct.html#a58edc7ddd17400641060790ec8c41be2">tss_struct::i387</a></div><div class="ttdeci">struct i387_struct i387</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00076">sched.h:77</a></div></div>
<div class="ttc" id="astructtss__struct_html_a690779f84552e81c65f7fe7f64509ae3"><div class="ttname"><a href="structtss__struct.html#a690779f84552e81c65f7fe7f64509ae3">tss_struct::cs</a></div><div class="ttdeci">long cs</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00070">sched.h:70</a></div></div>
<div class="ttc" id="astructtss__struct_html_a8c413a9f9fba57401c6637b654e5afb7"><div class="ttname"><a href="structtss__struct.html#a8c413a9f9fba57401c6637b654e5afb7">tss_struct::gs</a></div><div class="ttdeci">long gs</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00074">sched.h:74</a></div></div>
<div class="ttc" id="astructtss__struct_html_a8ca4b066e53d0ecf1a158cfaa724de0e"><div class="ttname"><a href="structtss__struct.html#a8ca4b066e53d0ecf1a158cfaa724de0e">tss_struct::eax</a></div><div class="ttdeci">long eax</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00064">sched.h:64</a></div></div>
<div class="ttc" id="astructtss__struct_html_aa4f02717786d9775affbb21e991ff6e5"><div class="ttname"><a href="structtss__struct.html#aa4f02717786d9775affbb21e991ff6e5">tss_struct::esp</a></div><div class="ttdeci">long esp</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00065">sched.h:65</a></div></div>
<div class="ttc" id="astructtss__struct_html_aa564439ea1eabeba14b0e8b7c0b4cba5"><div class="ttname"><a href="structtss__struct.html#aa564439ea1eabeba14b0e8b7c0b4cba5">tss_struct::ebx</a></div><div class="ttdeci">long ebx</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00064">sched.h:64</a></div></div>
<div class="ttc" id="astructtss__struct_html_aa8df65f6223dbabbb80fd77639758ff9"><div class="ttname"><a href="structtss__struct.html#aa8df65f6223dbabbb80fd77639758ff9">tss_struct::fs</a></div><div class="ttdeci">long fs</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00073">sched.h:73</a></div></div>
<div class="ttc" id="astructtss__struct_html_ab17663a45d8fac3e57549f30ffdfc8c6"><div class="ttname"><a href="structtss__struct.html#ab17663a45d8fac3e57549f30ffdfc8c6">tss_struct::esi</a></div><div class="ttdeci">long esi</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00067">sched.h:67</a></div></div>
<div class="ttc" id="astructtss__struct_html_ab71e63c68ca8ca2f4fa8f9740091f387"><div class="ttname"><a href="structtss__struct.html#ab71e63c68ca8ca2f4fa8f9740091f387">tss_struct::eip</a></div><div class="ttdeci">long eip</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00062">sched.h:62</a></div></div>
<div class="ttc" id="astructtss__struct_html_aba9d2203aec95e7b103a54f61a7f26be"><div class="ttname"><a href="structtss__struct.html#aba9d2203aec95e7b103a54f61a7f26be">tss_struct::eflags</a></div><div class="ttdeci">long eflags</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00063">sched.h:63</a></div></div>
<div class="ttc" id="astructtss__struct_html_ac04a5548296792b2958d77187279ed5f"><div class="ttname"><a href="structtss__struct.html#ac04a5548296792b2958d77187279ed5f">tss_struct::trace_bitmap</a></div><div class="ttdeci">long trace_bitmap</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00076">sched.h:76</a></div></div>
<div class="ttc" id="astructtss__struct_html_aeaf5c06a6b150bd3950ea232fd9e7ad2"><div class="ttname"><a href="structtss__struct.html#aeaf5c06a6b150bd3950ea232fd9e7ad2">tss_struct::es</a></div><div class="ttdeci">long es</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00069">sched.h:69</a></div></div>
<div class="ttc" id="astructtss__struct_html_afca380fb2cf2efd7b933865ee3287faf"><div class="ttname"><a href="structtss__struct.html#afca380fb2cf2efd7b933865ee3287faf">tss_struct::edi</a></div><div class="ttdeci">long edi</div><div class="ttdef"><b>Definition:</b> <a href="flash_2Linux-0_811_2include_2linux_2sched_8h_source.html#l00068">sched.h:68</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cbd7f246bdf7dc0a50281a272327e6ed.html">kernel</a></li><li class="navelem"><a class="el" href="src_2kernel_2fork_8c.html">fork.c</a></li>
    <li class="footer">Generated on Fri Sep 8 2023 09:26:40 for linux by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
